

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Synaptic events fitting &mdash; cls-interactive 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/style.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
        <script src="../../../_static/load_ga.js"></script>
        <script src="../../../_static/collapse.js"></script>
        <script src="../../../_static/banner.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Synaptic events fitting with user model" href="../syn_events_fituser_mod/syn_events_fituser_mod.html" />
    <link rel="prev" title="Neuro Feature extraction" href="../efel_gui/efel_gui.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> cls-interactive
          

          
            
            <img src="../../../_static/cls-banner.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc_status_monitor/hpc_status_monitor.html">HPC Status Monitor</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../online_usecases.html">Online Use Cases</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../trace_analysis.html">Trace Analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../efel_gui/efel_gui.html">Neuro Feature extraction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Synaptic events fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#synaptic-events-fitting-config">Synaptic events fitting - Config</a></li>
<li class="toctree-l4"><a class="reference internal" href="#synaptic-events-fitting-analysis">Synaptic events fitting - Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../syn_events_fituser_mod/syn_events_fituser_mod.html">Synaptic events fitting with user model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../syn_events_fit_user_data/syn_events_fit_user_data.html">Synaptic events fitting with user data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../morphology_analysis/morphology_analysis.html">Morphology Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../single_cell_modeling/single_cell_modeling.html">Single Cell Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../single_cell_in_silico/single_cell_in_silico.html">Single Cell <em>In Silico</em> Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../small_circuit_in_silico_experiments/small_circuit_in_silico_experiments.html">Small Circuit <em>In Silico</em> Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../brain_area_circuit_in_silico_experiments/brain_area_circuit_in_silico_experiments.html">Brain area circuit <em>in silico</em> experiments</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">cls-interactive</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../online_usecases.html">Online Use Cases</a> &raquo;</li>
        
          <li><a href="../trace_analysis.html">Trace Analysis</a> &raquo;</li>
        
      <li>Synaptic events fitting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/online_usecases/trace_analysis/syn_events_fit/syn_events_fit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="synaptic-events-fitting">
<span id="syn-events-fit"></span><h1>Synaptic events fitting<a class="headerlink" href="#synaptic-events-fitting" title="Permalink to this headline">¶</a></h1>
<p>This Use Case allows a user to fit synaptic events using data and models from the CSCS storage.</p>
<p>Selecting this Use Case, two Jupyter Notebooks are cloned in a private existing/new Collab.
The cloned Notebooks are:</p>
<div class="section" id="synaptic-events-fitting-config">
<h2>Synaptic events fitting - Config<a class="headerlink" href="#synaptic-events-fitting-config" title="Permalink to this headline">¶</a></h2>
<p>It allows the user to:</p>
<ol class="arabic simple">
<li><p>Select, download and visualize experimental data from the CSCS storage. The user may then select the data to be fitted.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/data_selection.png"><img alt="../../../_images/data_selection.png" class="align-center" src="../../../_images/data_selection.png" style="width: 850px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>A configuration file corresponding to the selected experimental file is
downloaded from the Collab storage. This file includes: the number of traces
in the experimental file, the protocol (voltage clamp amplitude and reversal
potential of the synapse), the name of the parameters to be fitted, their
initial values and the allowed variation range, exclusion rules, and an optional
set of dependencies for other parameters</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Select a default or a local mod file</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/mod_selection.png"><img alt="../../../_images/mod_selection.png" class="align-center" src="../../../_images/mod_selection.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>We assume that the user knows what we are talking about here, and that the
uploaded mod file has been already tested by the user in preliminary
simulations. The program does not check this. An invalid file will result in
errors at NEURON compilation time</p>
<p>When a local mod file is chosen, a form with the values needed to write a
corresponding configuration file is opened. The number of traces in the
experimental file and the protocol (voltage clamp amplitude and reversal
potential of the synapse) are by default filled with the values corresponding
to the chosen experimental file. The name of the parameters to be fitted, their
initial values and allowed variation range, exclusion rules, and an optional
set of dependencies for other parameters must be filled in by the user. Typical
values are shown in the figures below:</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/local_mod.png"><img alt="../../../_images/local_mod.png" class="align-center" src="../../../_images/local_mod.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/local_mod_values.png"><img alt="../../../_images/local_mod_values.png" class="align-center" src="../../../_images/local_mod_values.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/local_mod_values_params.png"><img alt="../../../_images/local_mod_values_params.png" class="align-center" src="../../../_images/local_mod_values_params.png" style="width: 500px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>All other parameters that are not fitted have their default value as defined in the mod file.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Configure the parameters of the optimization job: the title of the job, the number of nodes, the number of cores and the runtime. Run the fitting procedure using UNICORE authentication on JURECA (booster partition), GALILEO, or on NSG (using your account or the Service Account), and check the job status.</p></li>
</ol>
<p>On JURECA, the node number, the number of CPUs per node and the runtime are set by default to 2, 24 and 10m respectively.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>On GALILEO, the node number, the number of CPUs per node and the runtime are set by default to 2, 36 and 10m respectively.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The user needs to be aware of resource limitations imposed by each HPC system.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>On NSG, the node number, the number of cores and the runtime are set by
default to 2, 24 and 0.5 (hours) respectively. The maximum node number per job
is 72. If you would require more than 72 nodes, please contact
<a class="reference external" href="mailto:nsghelp&#37;&#52;&#48;sdsc&#46;edu">nsghelp<span>&#64;</span>sdsc<span>&#46;</span>edu</a>. The maximum number of cores required per node is 24.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/submission_process.png"><img alt="../../../_images/submission_process.png" class="align-center" src="../../../_images/submission_process.png" style="width: 650px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Note that when the job is submitted through UNICORE, the user can specify the project to use to submit the job on the HPC.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/unicore.png"><img alt="../../../_images/unicore.png" class="align-center" src="../../../_images/unicore.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Note that when the job is submitted through NSG, next to the status of the job, the user may see the submission date converted to CET time. It will be useful in the analysis notebook in order to fetch the job.</p>
<p>The user can choose to fit all the experimental traces 100 times, a single trace 20 times or a demo version where a trace is fitted 5 times. For the single trace and the demo version the user can choose the number of the trace to be fitted.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Once the job is completed, the output files will be in the Collab storage under different directories, according to the system used.</p>
<p>JURECA: results are saved under the resultsJureca/jobtitle_fitting_submissionTime folder.</p>
<p>GALILEO: results are saved under the resultsGalileo/jobtitle_fitting_submissionTime folder.</p>
<p>NSG results are saved under the resultsNSG/jobtitle_fitting_submissionTime folder.</p>
<p>NSG (Service Account) results are saved under the resultsNSG-SA/jobtitle_fitting_submissionTime folder.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="4">
<li><p>If you are interested in looking at the code, click on “Click here to toggle on/off the source code” button.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/toggle_button1.png"><img alt="../../../_images/toggle_button1.png" class="align-center" src="../../../_images/toggle_button1.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="5">
<li><p>If you want to start a new fitting from the beginning, click on “Click here to start a new fit” button.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/Restart.png"><img alt="../../../_images/Restart.png" class="align-center" src="../../../_images/Restart.png" style="width: 300px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="synaptic-events-fitting-analysis">
<h2>Synaptic events fitting - Analysis<a class="headerlink" href="#synaptic-events-fitting-analysis" title="Permalink to this headline">¶</a></h2>
<p>This Jupyter Notebook allows the user to fetch the fitting results from the
storage of the HPC system to the storage of the Collab or to analyze the
optimized parameters. If the user wants to view an analysis of simulations that
are already in the storage of the Collab, (s)he can skip the
‘View simulations’ tab and go directly to the ‘View analysis’ tab.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsim1.png"><img alt="../../../_images/viewsim1.png" class="align-center" src="../../../_images/viewsim1.png" style="width: 700px;" /></a>
</div>
<p>In the ‘View simulations’ tab, the user can visualize the Name/ID, status,
the submission date of the simulations submitted on the HPC systems and (s)he
can obtain an output of successfully completed jobs.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsimulations.png"><img alt="../../../_images/viewsimulations.png" class="align-center" src="../../../_images/viewsimulations.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsimulations2.png"><img alt="../../../_images/viewsimulations2.png" class="align-center" src="../../../_images/viewsimulations2.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewsimulations3.png"><img alt="../../../_images/viewsimulations3.png" class="align-center" src="../../../_images/viewsimulations3.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>In the ‘View analysis’ tab, the user can analyze the optimized parameters for
default data and a mod file combination or browse through the optimized
parameters available in the Collab storage.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/viewanalysis1.png"><img alt="../../../_images/viewanalysis1.png" class="align-center" src="../../../_images/viewanalysis1.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The user can visualize the data in table form, a box plot and the best fit.</p>
<ol class="arabic simple">
<li><p>The table of results (sorted in ascending order by the fitting error).</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/results_table.png"><img alt="../../../_images/results_table.png" class="align-center" src="../../../_images/results_table.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The boxplot of the normalized results.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/results_box.png"><img alt="../../../_images/results_box.png" class="align-center" src="../../../_images/results_box.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="3">
<li><p>The best fit.</p></li>
</ol>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/results_fit.png"><img alt="../../../_images/results_fit.png" class="align-center" src="../../../_images/results_fit.png" style="width: 700px;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>If you are interested in the code, click on the “Click here to toggle on/off
the source code” button.</p>
<div class="bsp-container-center docutils container">
<a class="reference internal image-reference" href="../../../_images/toggle_button2.png"><img alt="../../../_images/toggle_button2.png" class="align-center" src="../../../_images/toggle_button2.png" style="width: 300px;" /></a>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../syn_events_fituser_mod/syn_events_fituser_mod.html" class="btn btn-neutral float-right" title="Synaptic events fitting with user model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../efel_gui/efel_gui.html" class="btn btn-neutral float-left" title="Neuro Feature extraction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, EBRAINS Cellular Level Simulation Interactive members.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>